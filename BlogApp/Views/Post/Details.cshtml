@model BlogApp.Models.Post

@{
    ViewData["Title"] = "Post Details";
    if (User.Identity.IsAuthenticated)
    {
        // If you have roles stored in claims (like "Admin")
        if (User.IsInRole("Admin"))
        {
            Layout = "~/Views/Shared/AdminLayout.cshtml";
        }
        else if (User.IsInRole("User"))
        {
            Layout = "~/Views/Shared/UserLayout.cshtml";
        }
    }
    else
    {
        Layout = "~/Views/Shared/_Layout.cshtml"; // for non-logged-in visitors
    }
}

<h2>@Model.Title</h2>

@if (!string.IsNullOrEmpty(Model.PhotoPath))
{
    <img src="~/uploads/@Model.PhotoPath" width="400" alt="Post Image" class="img-fluid mb-3" />
}

<p>@Html.Raw(Model.Content)</p><!-- Views/Post/Details.cshtml -->


<p><strong>Status:</strong> @Model.Status</p>
<p><strong>Created At:</strong> @Model.CreatedAt.ToString("yyyy-MM-dd HH:mm")</p>

<a asp-action="Index" class="btn btn-secondary">Back to List</a>
<a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">Edit</a>
<!-- Trigger button -->
<button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#reportModal">Report</button>
<form asp-action="Like" asp-controller="Post" asp-route-postId="@Model.Id" method="post" style="display:inline;">
    <button type="submit" class="btn btn-outline-primary btn-sm">Like</button>

</form>
<p><strong>Total Likes:</strong> @Model.Likes?.Count()</p>

<!-- Modal -->
<div class="modal fade" id="reportModal" tabindex="-1">
    <div class="modal-dialog">
        <form asp-action="ReportPost" method="post">
            <input type="hidden" name="PostId" value="@Model.Id" />
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Report Post</h5>
                </div>
                <div class="modal-body">
                    <textarea name="Reason" class="form-control" placeholder="Reason for reporting..." required></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger">Submit Report</button>
                </div>
            </div>
        </form>
    </div>
</div>


